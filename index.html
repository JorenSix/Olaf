<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.14.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Olaf: Overly Lightweight Acoustic Fingerprinting (Olaf)</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Olaf
   </div>
   <div id="projectbrief">Overly Lightweight Acoustic Fingerprinting</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.14.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Overly Lightweight Acoustic Fingerprinting (Olaf) </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1 class="doxsection"><a class="anchor" id="intro_sec"></a>
Introduction</h1>
<p>Olaf is a C application / library for landmark based acoustic fingerprinting. Olaf is able to extract fingerprints from an audio stream, and either store those fingerprints in a database, or find a match between extracted fingerprints and stored fingerprints. Olaf does this efficiently in order to be used on embedded platforms, traditional computers or in web browsers via WASM.</p>
<p>Please be aware of the patents US7627477 B2 and US6990453 and perhaps others. They describe techniques used in algorithms implemented within Olaf. These patents limit the use of Olaf under various conditions and for several regions. Please make sure to consult your intellectual property rights specialist if you are in doubt about these restrictions. If these restrictions apply, please respect the patent holders rights. The main aim of Olaf is to serve as a learning platform on efficient (embedded) acoustic fingerprinting algorithms.</p>
<h1 class="doxsection"><a class="anchor" id="why_sec"></a>
Why Olaf?</h1>
<p>Olaf stands out for three reasons.</p><ol type="1">
<li>Olaf runs on embedded devices.</li>
<li>Olaf is fast on traditional computers.</li>
<li>Olaf runs in the browsers.</li>
</ol>
<p>There seem to be no lightweight acoustic fingerprinting libraries that are straightforward to run on embedded platforms. On embedded platforms memory and computational resources are severely limited. Olaf is written in portable C with these restrictions in mind. Olaf mainly targets 32-bit ARM devices such as some Teensy’s, some Arduino’s and the ESP32. Other modern embedded platforms with similar specifications and might work as well.</p>
<p>Olaf, being written in portable C, operates also on traditional computers. There, the efficiency of Olaf makes it run fast. On embedded devices reference fingerprints are stored in memory. On traditional computers fingerprints are stored in a high-performance key-value-store: LMDB. LMDB offers an a B+-tree based persistent storage ideal for small keys and values with low storage overhead.</p>
<p>Olaf works in the browser. Via Emscripten Olaf can be compiled to WASM. This makes it relatively straightforward to combine the capabilities of the Web Audio API and Olaf to create browser based audio fingerprinting applications.</p>
<h1 class="doxsection"><a class="anchor" id="design"></a>
Olaf's design</h1>
<p>The core of Olaf is kept as small as possible and is shared between the ESP32, WebAssembly and traditional version. The only difference is how audio enters the system. The default configuration expects monophonic, 32bit float audio sampled at 16kHz. Transcoding and resampling is different for each environment. <br  />
</p>
<p>For traditional computers file handling and transcoding is governed by a Ruby script. This script expands lists of incoming audio files, transcodes audio files, checks incoming audio, checks for duplicate material, validates arguments and input,... The Ruby script, essentially, makes Olaf an easy to use CLI application and keeps the C parts of Olaf simple. The C core it is not concerned with e.g. transcoding. Crucially, the C core trusts input and does not do much input validation and does not provide much guardrails. Since the interface is the Ruby script this seems warranted.</p>
<p>For the ESP32 version, only a small part of the core is used. To create a new ESP32 Arduino project, there is a small script which links to the core. The default Arduino setup uses C++ extensions so olaf_config.h remains olaf_config.h but <span class="tt">olaf_config.c</span> becomes <span class="tt">olaf_config.cpp</span>. Perhaps other environments (<a href="https://platformio.org/" title="PlatformIO">PlatformIO</a>) do not need this name change.</p>
<p>The WebAssembly version also uses a similarly small part of the core and some bridge code is available.</p>
<p>To verify both the ESP32 and WebAssembly versions, the Olaf C core can be compiled with the 'memory' database to mimic the ESP32/WebAssembly versions. In the compilation step the implementation for the <span class="tt">olaf_db.h</span> header is done by <span class="tt">olaf_db_mem.c</span> in stead of the standard <span class="tt">olaf_db.c</span> implementation. This paradigm of several implementations for a single header file is done a few times in Olaf. Olaf ships with several max-filter implementations.</p>
<h1 class="doxsection"><a class="anchor" id="configuration"></a>
Olaf's configuration</h1>
<p>The configuration of Olaf is set at compile time, since it is expected to not change in between runs. The default configuration is defined in the function olaf_config_default() in olaf_config.h. A different set of default configuration parameters is available for the memory version, ESP32 version (e.g. olaf_config_esp_32()) and the WebAssembly version. <br  />
</p>
<div>
<ul class="multicol">
</ul>
</div>
</div></div><!-- PageDoc -->
<a href="doxygen_crawl.html"></a>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.14.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
